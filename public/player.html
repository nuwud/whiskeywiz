<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whiskey Challenge - Player</title>

    <!-- Firebase CDN Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js"></script>

    <!-- Your Firebase Config -->
    <script src="./firebaseConfig.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Whiskey Challenge</h1>

    <!-- Login Form -->
    <div id="login-container">
        <h2>Login</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button id="login-btn">Login</button>
    </div>

    <!-- Quarters Container (only visible if logged in) -->
    <div id="quarters-container" style="display:none;">
        <!-- Quarters and samples will be dynamically inserted here -->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }

            const auth = firebase.auth();
            const db = firebase.firestore();
            const loginContainer = document.getElementById('login-container');
            const quartersContainer = document.getElementById('quarters-container');

            // Login Button Event Listener
            document.getElementById('login-btn').addEventListener('click', function() {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                auth.signInWithEmailAndPassword(email, password)
                    .then(() => {
                        alert('Logged in successfully!');
                        loginContainer.style.display = 'none';
                        quartersContainer.style.display = 'block';
                        loadQuarters();  // Load the quarters data
                    })
                    .catch(error => {
                        console.error('Error logging in:', error);
                        alert('Failed to login. Please try again.');
                    });
            });

            // Function to load quarters
            function loadQuarters() {
                db.collection('quarters').get().then(snapshot => {
                    snapshot.forEach(doc => {
                        const quarterData = doc.data();
                        createQuarterSection(quarterData, doc.id);
                    });
                }).catch(error => console.error('Error fetching quarters:', error));
            }

            // Function to create a quarter section
            function createQuarterSection(quarterData, quarterId) {
                const quarterDiv = document.createElement('div');
                quarterDiv.classList.add('quarter');
                quarterDiv.id = `quarter-${quarterId}`;

                const quarterHeader = document.createElement('h2');
                quarterHeader.innerText = `Quarter: ${quarterData.name}`;
                quarterDiv.appendChild(quarterHeader);

                quartersContainer.appendChild(quarterDiv);
            }
        });
    </script>
</body>

</html>
