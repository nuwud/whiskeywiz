<div class="game-container" [ngClass]="{'fade-out': transitioning}">
  <!-- Header with title and game status -->
  <div class="game-header">
    <h1 class="quarter-title">{{ getQuarterTitle() }}</h1>
  </div>

  <!-- Sample Navigation -->
  <div class="sample-navigation" [@panelFade]>
    <div class="nav-buttons">
      <button *ngFor="let btn of sampleButtons; let i = index"
              (click)="selectSample(i)"
              [class.active]="btn.active"
              [class.completed]="btn.completed"
              [attr.aria-label]="getSampleAriaLabel(i + 1)"
              class="sample-button">
        <span class="sample-letter">{{ btn.letter }}</span>
        <div class="completion-indicator" *ngIf="btn.completed">✓</div>
      </button>
    </div>
  </div>

  <!-- Main Game Content -->
  <div class="game-content" [@sampleTransition]="getPanelTransitionState(currentSample)">
    <!-- Age Guess Section -->
    <div class="guess-section">
      <h3>Age Statement</h3>
      <div class="slider-container">
        <input type="range" 
               min="1" 
               max="30" 
               [value]="getGuessValue(currentSample, 'age')"
               (input)="updateGuess(currentSample, 'age', $event.target.value)"
               class="custom-slider">
        <div class="slider-value">{{ getGuessValue(currentSample, 'age') }} years</div>
      </div>
    </div>

    <!-- Proof Guess Section -->
    <div class="guess-section">
      <h3>Proof</h3>
      <div class="slider-container">
        <input type="range" 
               min="80" 
               max="160" 
               [value]="getGuessValue(currentSample, 'proof')"
               (input)="updateGuess(currentSample, 'proof', $event.target.value)"
               class="custom-slider">
        <div class="slider-value">{{ getGuessValue(currentSample, 'proof') }}°</div>
      </div>
    </div>

    <!-- Mashbill Selection -->
    <div class="guess-section">
      <h3>Mashbill</h3>
      <div class="mashbill-options">
        <label *ngFor="let type of mashbillTypes" 
               class="mashbill-option"
               [class.selected]="getGuessValue(currentSample, 'mashbill') === type">
          <input type="radio" 
                 [value]="type" 
                 [checked]="getGuessValue(currentSample, 'mashbill') === type"
                 (change)="updateGuess(currentSample, 'mashbill', type)">
          <span class="radio-label">{{ type }}</span>
        </label>
      </div>
    </div>

    <!-- Rating Section -->
    <div class="guess-section">
      <h3>Your Rating</h3>
      <div class="star-rating">
        <div class="stars">
          <ng-container *ngFor="let i of [1,2,3,4,5,6,7,8,9,10]">
            <span class="star"
                  (click)="updateStarRating(currentSample, i)"
                  [class.filled]="i <= (starRatings['sample' + currentSample] || 0)">
              ⭐
            </span>
          </ng-container>
        </div>
        <div class="rating-value" *ngIf="starRatings['sample' + currentSample]">
          {{ starRatings['sample' + currentSample] }}/10
        </div>
      </div>
    </div>
  </div>

  <!-- Submit Section -->
  <div class="submit-section" *ngIf="!showResults">
    <button *ngIf="showSubmitAllButton()"
            (click)="submitGuesses()"
            class="submit-button"
            [disabled]="!areAllGuessesFilled()">
      Submit All Guesses
    </button>
  </div>

  <!-- Results View -->
  <div class="results-view" *ngIf="showResults" [@panelFade]>
    <div class="results-header">
      <h2>Final Score: {{ totalScore }}</h2>
      <div class="score-quip">{{ getScoreQuip() }}</div>
    </div>

    <div class="results-grid">
      <div *ngFor="let sample of [1,2,3,4]" class="result-card">
        <h3>Sample {{ getSampleLetter(sample) }}</h3>
        <div class="result-details">
          <div class="guess-comparison">
            <span>Age: {{ getGuessValue(sample, 'age') }} years</span>
            <span>Proof: {{ getGuessValue(sample, 'proof') }}°</span>
            <span>Mashbill: {{ getGuessValue(sample, 'mashbill') }}</span>
          </div>
          <div class="score-display">
            Score: {{ scores['sample' + sample] || 0 }} points
          </div>
        </div>
      </div>
    </div>

    <div class="action-buttons">
      <button (click)="share()" class="share-button">
        Share Results
      </button>
      <button (click)="playAgain()" class="play-again-button">
        Play Again
      </button>
    </div>
  </div>

  <!-- Error Display -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Authentication Section -->
  <div class="auth-section">
    <button (click)="handleAuth()" class="auth-button">
      {{ isGuest ? 'Login to Save Progress' : 'Logout' }}
    </button>
  </div>
</div>
